This pipeline uses VCF 4.0.

== Manifest file ==
TODO


== Perl scripts ==

wrapper.pl
Runs the pipeline, according to a manifest file.
--manifest manifest file


=== Filters ===
All filters output a filtered VCF file to STDOUT. This can be piped into another filter by passing "-" as VCF filename of the subsequent filter.


filter_coding_and_regions.pl
Adds filters to SNPs if they are in coding/noncoding regions, or if they are not in the chromosomes detailed in the manifest.
Uses $manifest->{'sequences'}->[].
--manifest manifest file
--vcf VCF file
--use_coding 0 or 1 (0 sets filter on coding SNPs)
--use_noncoding 0 or 1 (0 sets filter on noncoding SNPs)


filter_het_uniq.pl
Adds filters for heterozygous SNPs above a certain uniqueness value.
A SNP is heterozygous if at least one sample shows two or more alleles at a minimum coverage.
--manifest manifest file
--vcf VCF file
--min_cov minimum allele coverage to be counted as a call. Usually 1.
--max_uniq maximum uniqueness value for a heterozygous SNP to pass the filter.


filter_monoallelic.pl
Adds filters for (biallelic) SNPs that do not show each allele in at least one sample at a minimum coverage.
--manifest manifest file
--vcf VCF file
--min_cov minimum allele coverage


filter_biallelic.pl
Adds filters for SNPs that are not biallelic. Alleles below a certain total coverage are removed.
--manifest manifest file
--vcf VCF file
--min_cov minimum coverage for an allele to be considered "real"



filter_coverage.pl
Adds filters for excessive (low or high) converage in coding and non-coding regions, respecitvely. Relies on the "coverage_cutoffs.json" file generated by generate_coverage_cutoffs.pl
Uses $manifest->{'paths'}->{'coverage_cutoffs'}.
--manifest manifest file
--vcf VCF file
--range The "interdecile" range (e.g. 15 for 15%-85%)


filter_min_alt.pl
Adds filters for SNPs with a low alternate allele coverage. SNP fails if the minor allele has not at least $p_total% in all samples, or more than ${d_single}x depth in at least one sample.
--manifest manifest file
--vcf VCF file
--p_total MIN_PERCENT
--d_single MIN_DEPTH


filter_low_missingness.pl



=== Misc ===

generate_coverage_cutoffs.pl


snpfiles2vcf.pl


stats_low_missingness.pl


generate_snp_properties.pl


remove_samples.pl


stats_het_uniq.pl



== Perl modules ==

Variation.pm
Contains several useful functions, including manifest handling. Should be used by every Perl script in the pipeline.


Vcf.pm
Contains VCF read/write/parse functions. Copied from the vcftools package. Should be used by every Perl script in the pipeline.
